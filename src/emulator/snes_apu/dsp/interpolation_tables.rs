use multiversion::multiversion;

#[multiversion(targets = "simd")]
pub fn interp_dot(s: &[i32], p: &[i16]) -> i32 {
    s.iter().zip(p.iter()).fold(0, |c, (s, p)| c + *s * (*p as i32))
}

// High-fidelity 4-point Gaussian kernel
pub const GAUSSIAN_KERNEL_SIZE: usize = 4096;
pub const GAUSSIAN_KERNEL: [i16; GAUSSIAN_KERNEL_SIZE] = [
     247, 1567,  248,    0,  246, 1567,  249,    0,  246, 1567,  250,    1,  245, 1567,  251,    1,
     244, 1567,  252,    1,  243, 1567,  253,    1,  242, 1567,  254,    1,  241, 1567,  254,    1,
     240, 1567,  255,    1,  239, 1567,  256,    1,  238, 1567,  257,    1,  238, 1567,  258,    1,
     237, 1567,  259,    1,  236, 1567,  260,    1,  235, 1567,  261,    1,  234, 1567,  262,    1,
     233, 1567,  263,    1,  232, 1567,  264,    1,  232, 1566,  265,    1,  231, 1566,  266,    1,
     230, 1566,  267,    1,  229, 1566,  267,    1,  228, 1566,  268,    1,  227, 1566,  269,    1,
     227, 1566,  270,    1,  226, 1566,  271,    1,  225, 1565,  272,    1,  224, 1565,  273,    1,
     223, 1565,  274,    1,  222, 1565,  275,    1,  222, 1565,  276,    1,  221, 1565,  277,    1,
     220, 1564,  278,    1,  219, 1564,  279,    1,  218, 1564,  280,    1,  217, 1564,  281,    1,
     217, 1564,  282,    1,  216, 1563,  283,    1,  215, 1563,  284,    1,  214, 1563,  285,    1,
     213, 1563,  286,    1,  213, 1563,  287,    1,  212, 1562,  288,    1,  211, 1562,  289,    1,
     210, 1562,  290,    1,  209, 1562,  291,    1,  209, 1561,  292,    1,  208, 1561,  293,    1,
     207, 1561,  294,    1,  206, 1561,  295,    1,  206, 1560,  296,    1,  205, 1560,  297,    1,
     204, 1560,  298,    1,  203, 1559,  299,    1,  202, 1559,  300,    1,  202, 1559,  301,    1,
     201, 1559,  302,    1,  200, 1558,  303,    1,  199, 1558,  304,    1,  199, 1558,  305,    1,
     198, 1557,  306,    1,  197, 1557,  307,    1,  196, 1557,  308,    1,  196, 1556,  309,    1,
     195, 1556,  310,    1,  194, 1555,  311,    1,  193, 1555,  312,    1,  193, 1555,  313,    1,
     192, 1554,  315,    1,  191, 1554,  316,    1,  190, 1554,  317,    1,  190, 1553,  318,    1,
     189, 1553,  319,    1,  188, 1552,  320,    1,  188, 1552,  321,    1,  187, 1552,  322,    1,
     186, 1551,  323,    1,  185, 1551,  324,    1,  185, 1550,  325,    1,  184, 1550,  326,    1,
     183, 1549,  327,    1,  182, 1549,  328,    1,  182, 1549,  330,    1,  181, 1548,  331,    1,
     180, 1548,  332,    1,  180, 1547,  333,    1,  179, 1547,  334,    1,  178, 1546,  335,    1,
     178, 1546,  336,    1,  177, 1545,  337,    1,  176, 1545,  338,    1,  175, 1544,  339,    1,
     175, 1544,  341,    1,  174, 1543,  342,    1,  173, 1543,  343,    1,  173, 1542,  344,    1,
     172, 1542,  345,    1,  171, 1541,  346,    1,  171, 1541,  347,    1,  170, 1540,  348,    1,
     169, 1540,  350,    2,  169, 1539,  351,    2,  168, 1538,  352,    2,  167, 1538,  353,    2,
     167, 1537,  354,    2,  166, 1537,  355,    2,  165, 1536,  356,    2,  165, 1536,  358,    2,
     164, 1535,  359,    2,  163, 1534,  360,    2,  163, 1534,  361,    2,  162, 1533,  362,    2,
     161, 1533,  363,    2,  161, 1532,  365,    2,  160, 1531,  366,    2,  160, 1531,  367,    2,
     159, 1530,  368,    2,  158, 1530,  369,    2,  158, 1529,  370,    2,  157, 1528,  372,    2,
     156, 1528,  373,    2,  156, 1527,  374,    2,  155, 1526,  375,    2,  154, 1526,  376,    2,
     154, 1525,  378,    2,  153, 1524,  379,    2,  153, 1524,  380,    2,  152, 1523,  381,    2,
     151, 1522,  382,    2,  151, 1522,  384,    2,  150, 1521,  385,    2,  150, 1520,  386,    2,
     149, 1519,  387,    2,  148, 1519,  388,    2,  148, 1518,  390,    2,  147, 1517,  391,    2,
     147, 1517,  392,    2,  146, 1516,  393,    2,  145, 1515,  395,    2,  145, 1514,  396,    2,
     144, 1514,  397,    2,  144, 1513,  398,    2,  143, 1512,  399,    2,  142, 1511,  401,    2,
     142, 1511,  402,    2,  141, 1510,  403,    2,  141, 1509,  404,    2,  140, 1508,  406,    2,
     139, 1507,  407,    2,  139, 1507,  408,    2,  138, 1506,  409,    2,  138, 1505,  411,    2,
     137, 1504,  412,    2,  137, 1503,  413,    2,  136, 1503,  415,    2,  135, 1502,  416,    2,
     135, 1501,  417,    2,  134, 1500,  418,    2,  134, 1499,  420,    2,  133, 1498,  421,    2,
     133, 1498,  422,    2,  132, 1497,  423,    3,  132, 1496,  425,    3,  131, 1495,  426,    3,
     130, 1494,  427,    3,  130, 1493,  429,    3,  129, 1492,  430,    3,  129, 1492,  431,    3,
     128, 1491,  433,    3,  128, 1490,  434,    3,  127, 1489,  435,    3,  127, 1488,  436,    3,
     126, 1487,  438,    3,  126, 1486,  439,    3,  125, 1485,  440,    3,  125, 1484,  442,    3,
     124, 1483,  443,    3,  124, 1483,  444,    3,  123, 1482,  446,    3,  122, 1481,  447,    3,
     122, 1480,  448,    3,  121, 1479,  450,    3,  121, 1478,  451,    3,  120, 1477,  452,    3,
     120, 1476,  454,    3,  119, 1475,  455,    3,  119, 1474,  456,    3,  118, 1473,  458,    3,
     118, 1472,  459,    3,  117, 1471,  460,    3,  117, 1470,  462,    3,  116, 1469,  463,    3,
     116, 1468,  464,    3,  115, 1467,  466,    3,  115, 1466,  467,    3,  114, 1465,  469,    3,
     114, 1464,  470,    3,  113, 1463,  471,    3,  113, 1462,  473,    3,  112, 1461,  474,    3,
     112, 1460,  475,    3,  111, 1459,  477,    3,  111, 1458,  478,    3,  110, 1457,  480,    3,
     110, 1456,  481,    4,  110, 1455,  482,    4,  109, 1454,  484,    4,  109, 1453,  485,    4,
     108, 1452,  486,    4,  108, 1451,  488,    4,  107, 1450,  489,    4,  107, 1448,  491,    4,
     106, 1447,  492,    4,  106, 1446,  493,    4,  105, 1445,  495,    4,  105, 1444,  496,    4,
     104, 1443,  498,    4,  104, 1442,  499,    4,  103, 1441,  501,    4,  103, 1440,  502,    4,
     103, 1439,  503,    4,  102, 1437,  505,    4,  102, 1436,  506,    4,  101, 1435,  508,    4,
     101, 1434,  509,    4,  100, 1433,  511,    4,  100, 1432,  512,    4,   99, 1431,  513,    4,
      99, 1429,  515,    4,   99, 1428,  516,    4,   98, 1427,  518,    4,   98, 1426,  519,    4,
      97, 1425,  521,    4,   97, 1424,  522,    4,   96, 1423,  524,    4,   96, 1421,  525,    4,
      96, 1420,  526,    4,   95, 1419,  528,    4,   95, 1418,  529,    4,   94, 1417,  531,    5,
      94, 1415,  532,    5,   93, 1414,  534,    5,   93, 1413,  535,    5,   93, 1412,  537,    5,
      92, 1411,  538,    5,   92, 1409,  540,    5,   91, 1408,  541,    5,   91, 1407,  543,    5,
      91, 1406,  544,    5,   90, 1404,  546,    5,   90, 1403,  547,    5,   89, 1402,  549,    5,
      89, 1401,  550,    5,   89, 1399,  552,    5,   88, 1398,  553,    5,   88, 1397,  555,    5,
      87, 1396,  556,    5,   87, 1394,  558,    5,   87, 1393,  559,    5,   86, 1392,  561,    5,
      86, 1391,  562,    5,   85, 1389,  564,    5,   85, 1388,  565,    5,   85, 1387,  567,    5,
      84, 1386,  568,    5,   84, 1384,  570,    5,   83, 1383,  571,    5,   83, 1382,  573,    5,
      83, 1380,  574,    6,   82, 1379,  576,    6,   82, 1378,  577,    6,   82, 1376,  579,    6,
      81, 1375,  580,    6,   81, 1374,  582,    6,   80, 1372,  583,    6,   80, 1371,  585,    6,
      80, 1370,  586,    6,   79, 1368,  588,    6,   79, 1367,  590,    6,   79, 1366,  591,    6,
      78, 1364,  593,    6,   78, 1363,  594,    6,   78, 1362,  596,    6,   77, 1360,  597,    6,
      77, 1359,  599,    6,   77, 1358,  600,    6,   76, 1356,  602,    6,   76, 1355,  604,    6,
      75, 1354,  605,    6,   75, 1352,  607,    6,   75, 1351,  608,    6,   74, 1349,  610,    6,
      74, 1348,  611,    6,   74, 1347,  613,    7,   73, 1345,  615,    7,   73, 1344,  616,    7,
      73, 1342,  618,    7,   72, 1341,  619,    7,   72, 1340,  621,    7,   72, 1338,  622,    7,
      71, 1337,  624,    7,   71, 1335,  626,    7,   71, 1334,  627,    7,   70, 1333,  629,    7,
      70, 1331,  630,    7,   70, 1330,  632,    7,   69, 1328,  634,    7,   69, 1327,  635,    7,
      69, 1325,  637,    7,   68, 1324,  638,    7,   68, 1323,  640,    7,   68, 1321,  642,    7,
      67, 1320,  643,    7,   67, 1318,  645,    7,   67, 1317,  646,    7,   66, 1315,  648,    8,
      66, 1314,  650,    8,   66, 1312,  651,    8,   66, 1311,  653,    8,   65, 1309,  655,    8,
      65, 1308,  656,    8,   65, 1306,  658,    8,   64, 1305,  659,    8,   64, 1303,  661,    8,
      64, 1302,  663,    8,   63, 1300,  664,    8,   63, 1299,  666,    8,   63, 1298,  668,    8,
      62, 1296,  669,    8,   62, 1295,  671,    8,   62, 1293,  672,    8,   62, 1291,  674,    8,
      61, 1290,  676,    8,   61, 1288,  677,    8,   61, 1287,  679,    9,   60, 1285,  681,    9,
      60, 1284,  682,    9,   60, 1282,  684,    9,   60, 1281,  686,    9,   59, 1279,  687,    9,
      59, 1278,  689,    9,   59, 1276,  691,    9,   58, 1275,  692,    9,   58, 1273,  694,    9,
      58, 1272,  696,    9,   58, 1270,  697,    9,   57, 1269,  699,    9,   57, 1267,  701,    9,
      57, 1265,  702,    9,   56, 1264,  704,    9,   56, 1262,  706,    9,   56, 1261,  707,    9,
      56, 1259,  709,   10,   55, 1258,  711,   10,   55, 1256,  712,   10,   55, 1255,  714,   10,
      55, 1253,  716,   10,   54, 1251,  717,   10,   54, 1250,  719,   10,   54, 1248,  721,   10,
      54, 1247,  722,   10,   53, 1245,  724,   10,   53, 1244,  726,   10,   53, 1242,  727,   10,
      52, 1240,  729,   10,   52, 1239,  731,   10,   52, 1237,  733,   10,   52, 1236,  734,   10,
      51, 1234,  736,   11,   51, 1232,  738,   11,   51, 1231,  739,   11,   51, 1229,  741,   11,
      50, 1228,  743,   11,   50, 1226,  744,   11,   50, 1224,  746,   11,   50, 1223,  748,   11,
      49, 1221,  750,   11,   49, 1219,  751,   11,   49, 1218,  753,   11,   49, 1216,  755,   11,
      48, 1215,  756,   11,   48, 1213,  758,   11,   48, 1211,  760,   11,   48, 1210,  762,   12,
      48, 1208,  763,   12,   47, 1206,  765,   12,   47, 1205,  767,   12,   47, 1203,  768,   12,
      47, 1202,  770,   12,   46, 1200,  772,   12,   46, 1198,  774,   12,   46, 1197,  775,   12,
      46, 1195,  777,   12,   45, 1193,  779,   12,   45, 1192,  780,   12,   45, 1190,  782,   12,
      45, 1188,  784,   13,   44, 1187,  786,   13,   44, 1185,  787,   13,   44, 1183,  789,   13,
      44, 1182,  791,   13,   44, 1180,  793,   13,   43, 1178,  794,   13,   43, 1177,  796,   13,
      43, 1175,  798,   13,   43, 1173,  800,   13,   43, 1172,  801,   13,   42, 1170,  803,   13,
      42, 1168,  805,   13,   42, 1167,  806,   14,   42, 1165,  808,   14,   41, 1163,  810,   14,
      41, 1162,  812,   14,   41, 1160,  813,   14,   41, 1158,  815,   14,   41, 1157,  817,   14,
      40, 1155,  819,   14,   40, 1153,  820,   14,   40, 1151,  822,   14,   40, 1150,  824,   14,
      40, 1148,  826,   14,   39, 1146,  827,   15,   39, 1145,  829,   15,   39, 1143,  831,   15,
      39, 1141,  833,   15,   39, 1140,  834,   15,   38, 1138,  836,   15,   38, 1136,  838,   15,
      38, 1134,  840,   15,   38, 1133,  842,   15,   38, 1131,  843,   15,   37, 1129,  845,   15,
      37, 1128,  847,   15,   37, 1126,  849,   16,   37, 1124,  850,   16,   37, 1122,  852,   16,
      36, 1121,  854,   16,   36, 1119,  856,   16,   36, 1117,  857,   16,   36, 1116,  859,   16,
      36, 1114,  861,   16,   35, 1112,  863,   16,   35, 1110,  864,   16,   35, 1109,  866,   17,
      35, 1107,  868,   17,   35, 1105,  870,   17,   35, 1103,  872,   17,   34, 1102,  873,   17,
      34, 1100,  875,   17,   34, 1098,  877,   17,   34, 1096,  879,   17,   34, 1095,  880,   17,
      34, 1093,  882,   17,   33, 1091,  884,   17,   33, 1090,  886,   18,   33, 1088,  887,   18,
      33, 1086,  889,   18,   33, 1084,  891,   18,   32, 1083,  893,   18,   32, 1081,  895,   18,
      32, 1079,  896,   18,   32, 1077,  898,   18,   32, 1076,  900,   18,   32, 1074,  902,   19,
      31, 1072,  903,   19,   31, 1070,  905,   19,   31, 1069,  907,   19,   31, 1067,  909,   19,
      31, 1065,  911,   19,   31, 1063,  912,   19,   30, 1062,  914,   19,   30, 1060,  916,   19,
      30, 1058,  918,   20,   30, 1056,  919,   20,   30, 1054,  921,   20,   30, 1053,  923,   20,
      29, 1051,  925,   20,   29, 1049,  927,   20,   29, 1047,  928,   20,   29, 1046,  930,   20,
      29, 1044,  932,   20,   29, 1042,  934,   21,   29, 1040,  936,   21,   28, 1039,  937,   21,
      28, 1037,  939,   21,   28, 1035,  941,   21,   28, 1033,  943,   21,   28, 1032,  944,   21,
      28, 1030,  946,   21,   28, 1028,  948,   21,   27, 1026,  950,   22,   27, 1024,  952,   22,
      27, 1023,  953,   22,   27, 1021,  955,   22,   27, 1019,  957,   22,   27, 1017,  959,   22,
      26, 1016,  960,   22,   26, 1014,  962,   22,   26, 1012,  964,   23,   26, 1010,  966,   23,
      26, 1009,  968,   23,   26, 1007,  969,   23,   26, 1005,  971,   23,   25, 1003,  973,   23,
      25, 1001,  975,   23,   25, 1000,  977,   23,   25,  998,  978,   24,   25,  996,  980,   24,
      25,  994,  982,   24,   25,  993,  984,   24,   25,  991,  985,   24,   24,  989,  987,   24,
      24,  987,  989,   24,   24,  985,  991,   25,   24,  984,  993,   25,   24,  982,  994,   25,
      24,  980,  996,   25,   24,  978,  998,   25,   23,  977, 1000,   25,   23,  975, 1001,   25,
      23,  973, 1003,   25,   23,  971, 1005,   26,   23,  969, 1007,   26,   23,  968, 1009,   26,
      23,  966, 1010,   26,   23,  964, 1012,   26,   22,  962, 1014,   26,   22,  960, 1016,   26,
      22,  959, 1017,   27,   22,  957, 1019,   27,   22,  955, 1021,   27,   22,  953, 1023,   27,
      22,  952, 1024,   27,   22,  950, 1026,   27,   21,  948, 1028,   28,   21,  946, 1030,   28,
      21,  944, 1032,   28,   21,  943, 1033,   28,   21,  941, 1035,   28,   21,  939, 1037,   28,
      21,  937, 1039,   28,   21,  936, 1040,   29,   21,  934, 1042,   29,   20,  932, 1044,   29,
      20,  930, 1046,   29,   20,  928, 1047,   29,   20,  927, 1049,   29,   20,  925, 1051,   29,
      20,  923, 1053,   30,   20,  921, 1054,   30,   20,  919, 1056,   30,   20,  918, 1058,   30,
      19,  916, 1060,   30,   19,  914, 1062,   30,   19,  912, 1063,   31,   19,  911, 1065,   31,
      19,  909, 1067,   31,   19,  907, 1069,   31,   19,  905, 1070,   31,   19,  903, 1072,   31,
      19,  902, 1074,   32,   18,  900, 1076,   32,   18,  898, 1077,   32,   18,  896, 1079,   32,
      18,  895, 1081,   32,   18,  893, 1083,   32,   18,  891, 1084,   33,   18,  889, 1086,   33,
      18,  887, 1088,   33,   18,  886, 1090,   33,   17,  884, 1091,   33,   17,  882, 1093,   34,
      17,  880, 1095,   34,   17,  879, 1096,   34,   17,  877, 1098,   34,   17,  875, 1100,   34,
      17,  873, 1102,   34,   17,  872, 1103,   35,   17,  870, 1105,   35,   17,  868, 1107,   35,
      17,  866, 1109,   35,   16,  864, 1110,   35,   16,  863, 1112,   35,   16,  861, 1114,   36,
      16,  859, 1116,   36,   16,  857, 1117,   36,   16,  856, 1119,   36,   16,  854, 1121,   36,
      16,  852, 1122,   37,   16,  850, 1124,   37,   16,  849, 1126,   37,   15,  847, 1128,   37,
      15,  845, 1129,   37,   15,  843, 1131,   38,   15,  842, 1133,   38,   15,  840, 1134,   38,
      15,  838, 1136,   38,   15,  836, 1138,   38,   15,  834, 1140,   39,   15,  833, 1141,   39,
      15,  831, 1143,   39,   15,  829, 1145,   39,   15,  827, 1146,   39,   14,  826, 1148,   40,
      14,  824, 1150,   40,   14,  822, 1151,   40,   14,  820, 1153,   40,   14,  819, 1155,   40,
      14,  817, 1157,   41,   14,  815, 1158,   41,   14,  813, 1160,   41,   14,  812, 1162,   41,
      14,  810, 1163,   41,   14,  808, 1165,   42,   14,  806, 1167,   42,   13,  805, 1168,   42,
      13,  803, 1170,   42,   13,  801, 1172,   43,   13,  800, 1173,   43,   13,  798, 1175,   43,
      13,  796, 1177,   43,   13,  794, 1178,   43,   13,  793, 1180,   44,   13,  791, 1182,   44,
      13,  789, 1183,   44,   13,  787, 1185,   44,   13,  786, 1187,   44,   13,  784, 1188,   45,
      12,  782, 1190,   45,   12,  780, 1192,   45,   12,  779, 1193,   45,   12,  777, 1195,   46,
      12,  775, 1197,   46,   12,  774, 1198,   46,   12,  772, 1200,   46,   12,  770, 1202,   47,
      12,  768, 1203,   47,   12,  767, 1205,   47,   12,  765, 1206,   47,   12,  763, 1208,   48,
      12,  762, 1210,   48,   11,  760, 1211,   48,   11,  758, 1213,   48,   11,  756, 1215,   48,
      11,  755, 1216,   49,   11,  753, 1218,   49,   11,  751, 1219,   49,   11,  750, 1221,   49,
      11,  748, 1223,   50,   11,  746, 1224,   50,   11,  744, 1226,   50,   11,  743, 1228,   50,
      11,  741, 1229,   51,   11,  739, 1231,   51,   11,  738, 1232,   51,   11,  736, 1234,   51,
      10,  734, 1236,   52,   10,  733, 1237,   52,   10,  731, 1239,   52,   10,  729, 1240,   52,
      10,  727, 1242,   53,   10,  726, 1244,   53,   10,  724, 1245,   53,   10,  722, 1247,   54,
      10,  721, 1248,   54,   10,  719, 1250,   54,   10,  717, 1251,   54,   10,  716, 1253,   55,
      10,  714, 1255,   55,   10,  712, 1256,   55,   10,  711, 1258,   55,   10,  709, 1259,   56,
       9,  707, 1261,   56,    9,  706, 1262,   56,    9,  704, 1264,   56,    9,  702, 1265,   57,
       9,  701, 1267,   57,    9,  699, 1269,   57,    9,  697, 1270,   58,    9,  696, 1272,   58,
       9,  694, 1273,   58,    9,  692, 1275,   58,    9,  691, 1276,   59,    9,  689, 1278,   59,
       9,  687, 1279,   59,    9,  686, 1281,   60,    9,  684, 1282,   60,    9,  682, 1284,   60,
       9,  681, 1285,   60,    9,  679, 1287,   61,    8,  677, 1288,   61,    8,  676, 1290,   61,
       8,  674, 1291,   62,    8,  672, 1293,   62,    8,  671, 1295,   62,    8,  669, 1296,   62,
       8,  668, 1298,   63,    8,  666, 1299,   63,    8,  664, 1300,   63,    8,  663, 1302,   64,
       8,  661, 1303,   64,    8,  659, 1305,   64,    8,  658, 1306,   65,    8,  656, 1308,   65,
       8,  655, 1309,   65,    8,  653, 1311,   66,    8,  651, 1312,   66,    8,  650, 1314,   66,
       8,  648, 1315,   66,    7,  646, 1317,   67,    7,  645, 1318,   67,    7,  643, 1320,   67,
       7,  642, 1321,   68,    7,  640, 1323,   68,    7,  638, 1324,   68,    7,  637, 1325,   69,
       7,  635, 1327,   69,    7,  634, 1328,   69,    7,  632, 1330,   70,    7,  630, 1331,   70,
       7,  629, 1333,   70,    7,  627, 1334,   71,    7,  626, 1335,   71,    7,  624, 1337,   71,
       7,  622, 1338,   72,    7,  621, 1340,   72,    7,  619, 1341,   72,    7,  618, 1342,   73,
       7,  616, 1344,   73,    7,  615, 1345,   73,    7,  613, 1347,   74,    6,  611, 1348,   74,
       6,  610, 1349,   74,    6,  608, 1351,   75,    6,  607, 1352,   75,    6,  605, 1354,   75,
       6,  604, 1355,   76,    6,  602, 1356,   76,    6,  600, 1358,   77,    6,  599, 1359,   77,
       6,  597, 1360,   77,    6,  596, 1362,   78,    6,  594, 1363,   78,    6,  593, 1364,   78,
       6,  591, 1366,   79,    6,  590, 1367,   79,    6,  588, 1368,   79,    6,  586, 1370,   80,
       6,  585, 1371,   80,    6,  583, 1372,   80,    6,  582, 1374,   81,    6,  580, 1375,   81,
       6,  579, 1376,   82,    6,  577, 1378,   82,    6,  576, 1379,   82,    6,  574, 1380,   83,
       5,  573, 1382,   83,    5,  571, 1383,   83,    5,  570, 1384,   84,    5,  568, 1386,   84,
       5,  567, 1387,   85,    5,  565, 1388,   85,    5,  564, 1389,   85,    5,  562, 1391,   86,
       5,  561, 1392,   86,    5,  559, 1393,   87,    5,  558, 1394,   87,    5,  556, 1396,   87,
       5,  555, 1397,   88,    5,  553, 1398,   88,    5,  552, 1399,   89,    5,  550, 1401,   89,
       5,  549, 1402,   89,    5,  547, 1403,   90,    5,  546, 1404,   90,    5,  544, 1406,   91,
       5,  543, 1407,   91,    5,  541, 1408,   91,    5,  540, 1409,   92,    5,  538, 1411,   92,
       5,  537, 1412,   93,    5,  535, 1413,   93,    5,  534, 1414,   93,    5,  532, 1415,   94,
       5,  531, 1417,   94,    4,  529, 1418,   95,    4,  528, 1419,   95,    4,  526, 1420,   96,
       4,  525, 1421,   96,    4,  524, 1423,   96,    4,  522, 1424,   97,    4,  521, 1425,   97,
       4,  519, 1426,   98,    4,  518, 1427,   98,    4,  516, 1428,   99,    4,  515, 1429,   99,
       4,  513, 1431,   99,    4,  512, 1432,  100,    4,  511, 1433,  100,    4,  509, 1434,  101,
       4,  508, 1435,  101,    4,  506, 1436,  102,    4,  505, 1437,  102,    4,  503, 1439,  103,
       4,  502, 1440,  103,    4,  501, 1441,  103,    4,  499, 1442,  104,    4,  498, 1443,  104,
       4,  496, 1444,  105,    4,  495, 1445,  105,    4,  493, 1446,  106,    4,  492, 1447,  106,
       4,  491, 1448,  107,    4,  489, 1450,  107,    4,  488, 1451,  108,    4,  486, 1452,  108,
       4,  485, 1453,  109,    4,  484, 1454,  109,    4,  482, 1455,  110,    4,  481, 1456,  110,
       3,  480, 1457,  110,    3,  478, 1458,  111,    3,  477, 1459,  111,    3,  475, 1460,  112,
       3,  474, 1461,  112,    3,  473, 1462,  113,    3,  471, 1463,  113,    3,  470, 1464,  114,
       3,  469, 1465,  114,    3,  467, 1466,  115,    3,  466, 1467,  115,    3,  464, 1468,  116,
       3,  463, 1469,  116,    3,  462, 1470,  117,    3,  460, 1471,  117,    3,  459, 1472,  118,
       3,  458, 1473,  118,    3,  456, 1474,  119,    3,  455, 1475,  119,    3,  454, 1476,  120,
       3,  452, 1477,  120,    3,  451, 1478,  121,    3,  450, 1479,  121,    3,  448, 1480,  122,
       3,  447, 1481,  122,    3,  446, 1482,  123,    3,  444, 1483,  124,    3,  443, 1483,  124,
       3,  442, 1484,  125,    3,  440, 1485,  125,    3,  439, 1486,  126,    3,  438, 1487,  126,
       3,  436, 1488,  127,    3,  435, 1489,  127,    3,  434, 1490,  128,    3,  433, 1491,  128,
       3,  431, 1492,  129,    3,  430, 1492,  129,    3,  429, 1493,  130,    3,  427, 1494,  130,
       3,  426, 1495,  131,    3,  425, 1496,  132,    3,  423, 1497,  132,    2,  422, 1498,  133,
       2,  421, 1498,  133,    2,  420, 1499,  134,    2,  418, 1500,  134,    2,  417, 1501,  135,
       2,  416, 1502,  135,    2,  415, 1503,  136,    2,  413, 1503,  137,    2,  412, 1504,  137,
       2,  411, 1505,  138,    2,  409, 1506,  138,    2,  408, 1507,  139,    2,  407, 1507,  139,
       2,  406, 1508,  140,    2,  404, 1509,  141,    2,  403, 1510,  141,    2,  402, 1511,  142,
       2,  401, 1511,  142,    2,  399, 1512,  143,    2,  398, 1513,  144,    2,  397, 1514,  144,
       2,  396, 1514,  145,    2,  395, 1515,  145,    2,  393, 1516,  146,    2,  392, 1517,  147,
       2,  391, 1517,  147,    2,  390, 1518,  148,    2,  388, 1519,  148,    2,  387, 1519,  149,
       2,  386, 1520,  150,    2,  385, 1521,  150,    2,  384, 1522,  151,    2,  382, 1522,  151,
       2,  381, 1523,  152,    2,  380, 1524,  153,    2,  379, 1524,  153,    2,  378, 1525,  154,
       2,  376, 1526,  154,    2,  375, 1526,  155,    2,  374, 1527,  156,    2,  373, 1528,  156,
       2,  372, 1528,  157,    2,  370, 1529,  158,    2,  369, 1530,  158,    2,  368, 1530,  159,
       2,  367, 1531,  160,    2,  366, 1531,  160,    2,  365, 1532,  161,    2,  363, 1533,  161,
       2,  362, 1533,  162,    2,  361, 1534,  163,    2,  360, 1534,  163,    2,  359, 1535,  164,
       2,  358, 1536,  165,    2,  356, 1536,  165,    2,  355, 1537,  166,    2,  354, 1537,  167,
       2,  353, 1538,  167,    2,  352, 1538,  168,    2,  351, 1539,  169,    2,  350, 1540,  169,
       1,  348, 1540,  170,    1,  347, 1541,  171,    1,  346, 1541,  171,    1,  345, 1542,  172,
       1,  344, 1542,  173,    1,  343, 1543,  173,    1,  342, 1543,  174,    1,  341, 1544,  175,
       1,  339, 1544,  175,    1,  338, 1545,  176,    1,  337, 1545,  177,    1,  336, 1546,  178,
       1,  335, 1546,  178,    1,  334, 1547,  179,    1,  333, 1547,  180,    1,  332, 1548,  180,
       1,  331, 1548,  181,    1,  330, 1549,  182,    1,  328, 1549,  182,    1,  327, 1549,  183,
       1,  326, 1550,  184,    1,  325, 1550,  185,    1,  324, 1551,  185,    1,  323, 1551,  186,
       1,  322, 1552,  187,    1,  321, 1552,  188,    1,  320, 1552,  188,    1,  319, 1553,  189,
       1,  318, 1553,  190,    1,  317, 1554,  190,    1,  316, 1554,  191,    1,  315, 1554,  192,
       1,  313, 1555,  193,    1,  312, 1555,  193,    1,  311, 1555,  194,    1,  310, 1556,  195,
       1,  309, 1556,  196,    1,  308, 1557,  196,    1,  307, 1557,  197,    1,  306, 1557,  198,
       1,  305, 1558,  199,    1,  304, 1558,  199,    1,  303, 1558,  200,    1,  302, 1559,  201,
       1,  301, 1559,  202,    1,  300, 1559,  202,    1,  299, 1559,  203,    1,  298, 1560,  204,
       1,  297, 1560,  205,    1,  296, 1560,  206,    1,  295, 1561,  206,    1,  294, 1561,  207,
       1,  293, 1561,  208,    1,  292, 1561,  209,    1,  291, 1562,  209,    1,  290, 1562,  210,
       1,  289, 1562,  211,    1,  288, 1562,  212,    1,  287, 1563,  213,    1,  286, 1563,  213,
       1,  285, 1563,  214,    1,  284, 1563,  215,    1,  283, 1563,  216,    1,  282, 1564,  217,
       1,  281, 1564,  217,    1,  280, 1564,  218,    1,  279, 1564,  219,    1,  278, 1564,  220,
       1,  277, 1565,  221,    1,  276, 1565,  222,    1,  275, 1565,  222,    1,  274, 1565,  223,
       1,  273, 1565,  224,    1,  272, 1565,  225,    1,  271, 1566,  226,    1,  270, 1566,  227,
       1,  269, 1566,  227,    1,  268, 1566,  228,    1,  267, 1566,  229,    1,  267, 1566,  230,
       1,  266, 1566,  231,    1,  265, 1566,  232,    1,  264, 1567,  232,    1,  263, 1567,  233,
       1,  262, 1567,  234,    1,  261, 1567,  235,    1,  260, 1567,  236,    1,  259, 1567,  237,
       1,  258, 1567,  238,    1,  257, 1567,  238,    1,  256, 1567,  239,    1,  255, 1567,  240,
       1,  254, 1567,  241,    1,  254, 1567,  242,    1,  253, 1567,  243,    1,  252, 1567,  244,
       1,  251, 1567,  245,    1,  250, 1567,  246,    0,  249, 1567,  246,    0,  248, 1567,  247,
];

// S-DSP 4-point Gaussian kernel
pub const ACCURATE_GAUSSIAN_KERNEL_SIZE: usize = 1024;
pub const ACCURATE_GAUSSIAN_KERNEL: [i16; ACCURATE_GAUSSIAN_KERNEL_SIZE] = [
    370, 1305,  374,    0,  366, 1305,  378,    0,  362, 1304,  381,    0,  358, 1304,  385,    0,
    354, 1304,  389,    0,  351, 1304,  393,    0,  347, 1304,  397,    0,  343, 1303,  401,    0,
    339, 1303,  405,    0,  336, 1303,  410,    0,  332, 1302,  414,    0,  328, 1302,  418,    0,
    325, 1301,  422,    0,  321, 1300,  426,    0,  318, 1300,  430,    0,  314, 1299,  434,    0,
    311, 1298,  439,    1,  307, 1297,  443,    1,  304, 1297,  447,    1,  300, 1296,  451,    1,
    297, 1295,  456,    1,  293, 1294,  460,    1,  290, 1293,  464,    1,  286, 1292,  469,    1,
    283, 1291,  473,    1,  280, 1290,  477,    1,  276, 1288,  482,    1,  273, 1287,  486,    2,
    270, 1286,  491,    2,  267, 1284,  495,    2,  263, 1283,  499,    2,  260, 1282,  504,    2,
    257, 1280,  508,    2,  254, 1279,  513,    2,  251, 1277,  517,    3,  248, 1275,  522,    3,
    245, 1274,  527,    3,  242, 1272,  531,    3,  239, 1270,  536,    3,  236, 1269,  540,    4,
    233, 1267,  545,    4,  230, 1265,  550,    4,  227, 1263,  554,    4,  224, 1261,  559,    4,
    221, 1259,  563,    5,  218, 1257,  568,    5,  215, 1255,  573,    5,  212, 1253,  577,    5,
    210, 1251,  582,    6,  207, 1248,  587,    6,  204, 1246,  592,    6,  201, 1244,  596,    6,
    199, 1241,  601,    7,  196, 1239,  606,    7,  193, 1237,  611,    7,  191, 1234,  615,    8,
    188, 1232,  620,    8,  186, 1229,  625,    8,  183, 1227,  630,    9,  180, 1224,  635,    9,
    178, 1221,  640,    9,  175, 1219,  644,   10,  173, 1216,  649,   10,  171, 1213,  654,   10,
    168, 1210,  659,   11,  166, 1207,  664,   11,  163, 1205,  669,   11,  161, 1202,  674,   12,
    159, 1199,  678,   12,  156, 1196,  683,   13,  154, 1193,  688,   13,  152, 1190,  693,   14,
    150, 1186,  698,   14,  147, 1183,  703,   15,  145, 1180,  708,   15,  143, 1177,  713,   15,
    141, 1174,  718,   16,  139, 1170,  723,   16,  137, 1167,  728,   17,  134, 1164,  732,   17,
    132, 1160,  737,   18,  130, 1157,  742,   19,  128, 1153,  747,   19,  126, 1150,  752,   20,
    124, 1146,  757,   20,  122, 1143,  762,   21,  120, 1139,  767,   21,  118, 1136,  772,   22,
    117, 1132,  777,   23,  115, 1128,  782,   23,  113, 1125,  787,   24,  111, 1121,  792,   24,
    109, 1117,  797,   25,  107, 1113,  802,   26,  106, 1109,  806,   27,  104, 1106,  811,   27,
    102, 1102,  816,   28,  100, 1098,  821,   29,   99, 1094,  826,   29,   97, 1090,  831,   30,
    95, 1086,  836,   31,   94, 1082,  841,   32,   92, 1078,  846,   32,   90, 1074,  851,   33,
    89, 1070,  855,   34,   87, 1066,  860,   35,   86, 1061,  865,   36,   84, 1057,  870,   36,
    83, 1053,  875,   37,   81, 1049,  880,   38,   80, 1045,  884,   39,   78, 1040,  889,   40,
    77, 1036,  894,   41,   76, 1032,  899,   42,   74, 1027,  904,   43,   73, 1023,  908,   44,
    71, 1019,  913,   45,   70, 1014,  918,   46,   69, 1010,  923,   47,   67, 1005,  927,   48,
    66, 1001,  932,   49,   65,  997,  937,   50,   64,  992,  941,   51,   62,  988,  946,   52,
    61,  983,  951,   53,   60,  978,  955,   54,   59,  974,  960,   55,   58,  969,  965,   56,
    56,  965,  969,   58,   55,  960,  974,   59,   54,  955,  978,   60,   53,  951,  983,   61,
    52,  946,  988,   62,   51,  941,  992,   64,   50,  937,  997,   65,   49,  932, 1001,   66,
    48,  927, 1005,   67,   47,  923, 1010,   69,   46,  918, 1014,   70,   45,  913, 1019,   71,
    44,  908, 1023,   73,   43,  904, 1027,   74,   42,  899, 1032,   76,   41,  894, 1036,   77,
    40,  889, 1040,   78,   39,  884, 1045,   80,   38,  880, 1049,   81,   37,  875, 1053,   83,
    36,  870, 1057,   84,   36,  865, 1061,   86,   35,  860, 1066,   87,   34,  855, 1070,   89,
    33,  851, 1074,   90,   32,  846, 1078,   92,   32,  841, 1082,   94,   31,  836, 1086,   95,
    30,  831, 1090,   97,   29,  826, 1094,   99,   29,  821, 1098,  100,   28,  816, 1102,  102,
    27,  811, 1106,  104,   27,  806, 1109,  106,   26,  802, 1113,  107,   25,  797, 1117,  109,
    24,  792, 1121,  111,   24,  787, 1125,  113,   23,  782, 1128,  115,   23,  777, 1132,  117,
    22,  772, 1136,  118,   21,  767, 1139,  120,   21,  762, 1143,  122,   20,  757, 1146,  124,
    20,  752, 1150,  126,   19,  747, 1153,  128,   19,  742, 1157,  130,   18,  737, 1160,  132,
    17,  732, 1164,  134,   17,  728, 1167,  137,   16,  723, 1170,  139,   16,  718, 1174,  141,
    15,  713, 1177,  143,   15,  708, 1180,  145,   15,  703, 1183,  147,   14,  698, 1186,  150,
    14,  693, 1190,  152,   13,  688, 1193,  154,   13,  683, 1196,  156,   12,  678, 1199,  159,
    12,  674, 1202,  161,   11,  669, 1205,  163,   11,  664, 1207,  166,   11,  659, 1210,  168,
    10,  654, 1213,  171,   10,  649, 1216,  173,   10,  644, 1219,  175,    9,  640, 1221,  178,
    9,  635, 1224,  180,    9,  630, 1227,  183,    8,  625, 1229,  186,    8,  620, 1232,  188,
    8,  615, 1234,  191,    7,  611, 1237,  193,    7,  606, 1239,  196,    7,  601, 1241,  199,
    6,  596, 1244,  201,    6,  592, 1246,  204,    6,  587, 1248,  207,    6,  582, 1251,  210,
    5,  577, 1253,  212,    5,  573, 1255,  215,    5,  568, 1257,  218,    5,  563, 1259,  221,
    4,  559, 1261,  224,    4,  554, 1263,  227,    4,  550, 1265,  230,    4,  545, 1267,  233,
    4,  540, 1269,  236,    3,  536, 1270,  239,    3,  531, 1272,  242,    3,  527, 1274,  245,
    3,  522, 1275,  248,    3,  517, 1277,  251,    2,  513, 1279,  254,    2,  508, 1280,  257,
    2,  504, 1282,  260,    2,  499, 1283,  263,    2,  495, 1284,  267,    2,  491, 1286,  270,
    2,  486, 1287,  273,    1,  482, 1288,  276,    1,  477, 1290,  280,    1,  473, 1291,  283,
    1,  469, 1292,  286,    1,  464, 1293,  290,    1,  460, 1294,  293,    1,  456, 1295,  297,
    1,  451, 1296,  300,    1,  447, 1297,  304,    1,  443, 1297,  307,    1,  439, 1298,  311,
    0,  434, 1299,  314,    0,  430, 1300,  318,    0,  426, 1300,  321,    0,  422, 1301,  325,
    0,  418, 1302,  328,    0,  414, 1302,  332,    0,  410, 1303,  336,    0,  405, 1303,  339,
    0,  401, 1303,  343,    0,  397, 1304,  347,    0,  393, 1304,  351,    0,  389, 1304,  354,
    0,  385, 1304,  358,    0,  381, 1304,  362,    0,  378, 1305,  366,    0,  374, 1305,  370,
];

// 8-point Whittaker-Shannon interpolation kernel
pub const SINC_KERNEL_SIZE: usize = 2048;
pub const SINC_KERNEL: [i16; SINC_KERNEL_SIZE] = [
        0,     0,     0, 32767,     0,     0,     0,     0,    -6,    31,  -108, 32767,   109,   -32,     6,     0,
      -12,    63,  -216, 32764,   220,   -64,    12,     0,   -18,    94,  -322, 32759,   332,   -97,    19,     0,
      -24,   125,  -427, 32753,   446,  -130,    25,     0,   -29,   155,  -532, 32745,   560,  -163,    32,     0,
      -35,   186,  -635, 32735,   675,  -197,    39,     0,   -41,   215,  -736, 32723,   792,  -231,    46,     0,
      -46,   245,  -837, 32710,   909,  -266,    53,     0,   -51,   274,  -936, 32695,  1028,  -300,    60,     0,
      -57,   303, -1035, 32678,  1148,  -335,    67,     0,   -62,   331, -1132, 32659,  1269,  -370,    75,     0,
      -67,   360, -1228, 32638,  1391,  -406,    82,     0,   -72,   387, -1323, 32616,  1514,  -441,    90,     0,
      -76,   415, -1416, 32591,  1638,  -478,    98,     0,   -81,   442, -1509, 32566,  1763,  -514,   105,     0,
      -86,   469, -1600, 32538,  1889,  -550,   113,     0,   -90,   495, -1690, 32508,  2016,  -587,   121,     0,
      -94,   521, -1779, 32477,  2144,  -624,   129,     0,   -99,   547, -1867, 32444,  2274,  -662,   138,     0,
     -103,   572, -1953, 32409,  2404,  -699,   146,     0,  -107,   597, -2039, 32372,  2535,  -737,   154,     0,
     -111,   621, -2123, 32334,  2667,  -775,   163,     0,  -115,   646, -2206, 32294,  2801,  -814,   171,     0,
     -118,   669, -2288, 32252,  2935,  -852,   180,    -1,  -122,   693, -2368, 32208,  3070,  -891,   189,    -1,
     -125,   716, -2448, 32163,  3206,  -930,   198,    -1,  -129,   739, -2526, 32116,  3344,  -969,   207,    -1,
     -132,   761, -2603, 32067,  3482, -1009,   216,    -1,  -135,   783, -2679, 32017,  3621, -1048,   225,    -1,
     -139,   805, -2753, 31964,  3761, -1088,   234,    -2,  -142,   826, -2827, 31911,  3902, -1128,   244,    -2,
     -144,   847, -2899, 31855,  4044, -1168,   253,    -2,  -147,   867, -2970, 31798,  4186, -1209,   263,    -2,
     -150,   887, -3040, 31738,  4330, -1249,   272,    -2,  -153,   907, -3108, 31678,  4474, -1290,   282,    -3,
     -155,   926, -3176, 31615,  4620, -1331,   292,    -3,  -158,   945, -3242, 31551,  4766, -1372,   302,    -3,
     -160,   964, -3307, 31485,  4913, -1413,   312,    -4,  -162,   982, -3371, 31418,  5061, -1455,   322,    -4,
     -164,  1000, -3434, 31349,  5210, -1496,   332,    -4,  -166,  1018, -3495, 31278,  5360, -1538,   342,    -5,
     -168,  1035, -3556, 31206,  5510, -1580,   353,    -5,  -170,  1051, -3615, 31132,  5662, -1621,   363,    -5,
     -172,  1068, -3673, 31056,  5814, -1663,   373,    -6,  -174,  1084, -3730, 30979,  5967, -1706,   384,    -6,
     -175,  1100, -3785, 30900,  6120, -1748,   395,    -7,  -177,  1115, -3840, 30820,  6275, -1790,   405,    -7,
     -178,  1130, -3893, 30738,  6430, -1833,   416,    -8,  -180,  1144, -3945, 30654,  6586, -1875,   427,    -8,
     -181,  1158, -3996, 30569,  6742, -1918,   438,    -9,  -182,  1172, -4046, 30482,  6900, -1960,   449,    -9,
     -183,  1186, -4094, 30394,  7058, -2003,   460,   -10,  -184,  1199, -4142, 30304,  7216, -2046,   471,   -10,
     -185,  1211, -4188, 30213,  7376, -2089,   482,   -11,  -186,  1224, -4233, 30120,  7536, -2132,   493,   -12,
     -187,  1236, -4277, 30026,  7697, -2174,   504,   -12,  -188,  1247, -4320, 29930,  7858, -2217,   515,   -13,
     -188,  1259, -4362, 29833,  8020, -2260,   527,   -14,  -189,  1270, -4402, 29734,  8183, -2303,   538,   -14,
     -189,  1280, -4442, 29633,  8346, -2346,   549,   -15,  -190,  1290, -4480, 29532,  8510, -2389,   561,   -16,
     -190,  1300, -4518, 29428,  8674, -2432,   572,   -17,  -191,  1310, -4554, 29324,  8839, -2475,   584,   -18,
     -191,  1319, -4589, 29218,  9005, -2518,   595,   -18,  -191,  1328, -4623, 29110,  9171, -2561,   607,   -19,
     -191,  1336, -4655, 29001,  9337, -2604,   619,   -20,  -191,  1344, -4687, 28891,  9504, -2646,   630,   -21,
     -191,  1352, -4718, 28779,  9672, -2689,   642,   -22,  -191,  1359, -4747, 28666,  9840, -2732,   654,   -23,
     -191,  1366, -4776, 28552, 10009, -2774,   665,   -24,  -190,  1373, -4803, 28436, 10178, -2817,   677,   -25,
     -190,  1379, -4829, 28319, 10347, -2859,   689,   -26,  -190,  1386, -4855, 28201, 10517, -2901,   701,   -27,
     -189,  1391, -4879, 28081, 10687, -2943,   713,   -28,  -189,  1397, -4902, 27960, 10858, -2985,   724,   -29,
     -188,  1402, -4924, 27838, 11029, -3027,   736,   -30,  -188,  1407, -4945, 27714, 11200, -3069,   748,   -31,
     -187,  1411, -4965, 27589, 11372, -3111,   760,   -32,  -186,  1415, -4984, 27463, 11544, -3152,   772,   -34,
     -186,  1419, -5002, 27336, 11717, -3194,   783,   -35,  -185,  1423, -5019, 27207, 11890, -3235,   795,   -36,
     -184,  1426, -5035, 27078, 12063, -3276,   807,   -37,  -183,  1429, -5050, 26947, 12236, -3316,   819,   -38,
     -182,  1431, -5064, 26815, 12409, -3357,   831,   -40,  -181,  1433, -5076, 26681, 12583, -3397,   842,   -41,
     -180,  1435, -5088, 26547, 12757, -3438,   854,   -42,  -179,  1437, -5099, 26412, 12932, -3477,   866,   -44,
     -178,  1439, -5109, 26275, 13106, -3517,   878,   -45,  -177,  1440, -5118, 26137, 13281, -3557,   889,   -46,
     -176,  1440, -5127, 25998, 13456, -3596,   901,   -48,  -175,  1441, -5134, 25858, 13631, -3635,   912,   -49,
     -173,  1441, -5140, 25717, 13806, -3673,   924,   -51,  -172,  1441, -5145, 25575, 13981, -3712,   936,   -52,
     -171,  1441, -5150, 25432, 14156, -3750,   947,   -54,  -169,  1440, -5153, 25288, 14332, -3788,   958,   -55,
     -168,  1439, -5155, 25143, 14507, -3825,   970,   -57,  -167,  1438, -5157, 24997, 14683, -3862,   981,   -58,
     -165,  1437, -5158, 24850, 14859, -3899,   992,   -60,  -164,  1435, -5158, 24702, 15034, -3936,  1004,   -61,
     -162,  1433, -5157, 24553, 15210, -3972,  1015,   -63,  -161,  1431, -5155, 24404, 15386, -4008,  1026,   -65,
     -159,  1429, -5152, 24253, 15561, -4043,  1037,   -66,  -158,  1426, -5148, 24101, 15737, -4078,  1048,   -68,
     -156,  1423, -5144, 23949, 15913, -4113,  1059,   -70,  -154,  1420, -5139, 23795, 16088, -4147,  1069,   -71,
     -153,  1416, -5133, 23641, 16263, -4181,  1080,   -73,  -151,  1413, -5126, 23486, 16439, -4215,  1091,   -75,
     -149,  1409, -5118, 23330, 16614, -4248,  1101,   -76,  -148,  1405, -5109, 23173, 16789, -4281,  1111,   -78,
     -146,  1400, -5100, 23016, 16964, -4313,  1122,   -80,  -144,  1396, -5090, 22858, 17139, -4345,  1132,   -82,
     -142,  1391, -5079, 22699, 17313, -4376,  1142,   -83,  -141,  1386, -5067, 22539, 17487, -4407,  1152,   -85,
     -139,  1381, -5055, 22379, 17661, -4437,  1162,   -87,  -137,  1375, -5042, 22218, 17835, -4467,  1172,   -89,
     -135,  1370, -5028, 22056, 18009, -4496,  1182,   -91,  -133,  1364, -5013, 21893, 18182, -4525,  1191,   -92,
     -132,  1358, -4998, 21730, 18355, -4554,  1201,   -94,  -130,  1352, -4982, 21566, 18528, -4581,  1210,   -96,
     -128,  1345, -4965, 21402, 18700, -4609,  1219,   -98,  -126,  1339, -4948, 21237, 18873, -4636,  1228,  -100,
     -124,  1332, -4930, 21071, 19044, -4662,  1237,  -102,  -122,  1325, -4911, 20905, 19216, -4687,  1246,  -104,
     -120,  1318, -4891, 20738, 19387, -4712,  1254,  -105,  -119,  1310, -4871, 20571, 19557, -4737,  1263,  -107,
     -117,  1303, -4850, 20403, 19727, -4761,  1271,  -109,  -115,  1295, -4829, 20235, 19897, -4784,  1279,  -111,
     -113,  1287, -4807, 20066, 20066, -4807,  1287,  -113,  -111,  1279, -4784, 19897, 20235, -4829,  1295,  -115,
     -109,  1271, -4761, 19727, 20403, -4850,  1303,  -117,  -107,  1263, -4737, 19557, 20571, -4871,  1310,  -119,
     -105,  1254, -4712, 19387, 20738, -4891,  1318,  -120,  -104,  1246, -4687, 19216, 20905, -4911,  1325,  -122,
     -102,  1237, -4662, 19044, 21071, -4930,  1332,  -124,  -100,  1228, -4636, 18873, 21237, -4948,  1339,  -126,
      -98,  1219, -4609, 18700, 21402, -4965,  1345,  -128,   -96,  1210, -4581, 18528, 21566, -4982,  1352,  -130,
      -94,  1201, -4554, 18355, 21730, -4998,  1358,  -132,   -92,  1191, -4525, 18182, 21893, -5013,  1364,  -133,
      -91,  1182, -4496, 18009, 22056, -5028,  1370,  -135,   -89,  1172, -4467, 17835, 22218, -5042,  1375,  -137,
      -87,  1162, -4437, 17661, 22379, -5055,  1381,  -139,   -85,  1152, -4407, 17487, 22539, -5067,  1386,  -141,
      -83,  1142, -4376, 17313, 22699, -5079,  1391,  -142,   -82,  1132, -4345, 17139, 22858, -5090,  1396,  -144,
      -80,  1122, -4313, 16964, 23016, -5100,  1400,  -146,   -78,  1111, -4281, 16789, 23173, -5109,  1405,  -148,
      -76,  1101, -4248, 16614, 23330, -5118,  1409,  -149,   -75,  1091, -4215, 16439, 23486, -5126,  1413,  -151,
      -73,  1080, -4181, 16263, 23641, -5133,  1416,  -153,   -71,  1069, -4147, 16088, 23795, -5139,  1420,  -154,
      -70,  1059, -4113, 15913, 23949, -5144,  1423,  -156,   -68,  1048, -4078, 15737, 24101, -5148,  1426,  -158,
      -66,  1037, -4043, 15561, 24253, -5152,  1429,  -159,   -65,  1026, -4008, 15386, 24404, -5155,  1431,  -161,
      -63,  1015, -3972, 15210, 24553, -5157,  1433,  -162,   -61,  1004, -3936, 15034, 24702, -5158,  1435,  -164,
      -60,   992, -3899, 14859, 24850, -5158,  1437,  -165,   -58,   981, -3862, 14683, 24997, -5157,  1438,  -167,
      -57,   970, -3825, 14507, 25143, -5155,  1439,  -168,   -55,   958, -3788, 14332, 25288, -5153,  1440,  -169,
      -54,   947, -3750, 14156, 25432, -5150,  1441,  -171,   -52,   936, -3712, 13981, 25575, -5145,  1441,  -172,
      -51,   924, -3673, 13806, 25717, -5140,  1441,  -173,   -49,   912, -3635, 13631, 25858, -5134,  1441,  -175,
      -48,   901, -3596, 13456, 25998, -5127,  1440,  -176,   -46,   889, -3557, 13281, 26137, -5118,  1440,  -177,
      -45,   878, -3517, 13106, 26275, -5109,  1439,  -178,   -44,   866, -3477, 12932, 26412, -5099,  1437,  -179,
      -42,   854, -3438, 12757, 26547, -5088,  1435,  -180,   -41,   842, -3397, 12583, 26681, -5076,  1433,  -181,
      -40,   831, -3357, 12409, 26815, -5064,  1431,  -182,   -38,   819, -3316, 12236, 26947, -5050,  1429,  -183,
      -37,   807, -3276, 12063, 27078, -5035,  1426,  -184,   -36,   795, -3235, 11890, 27207, -5019,  1423,  -185,
      -35,   783, -3194, 11717, 27336, -5002,  1419,  -186,   -34,   772, -3152, 11544, 27463, -4984,  1415,  -186,
      -32,   760, -3111, 11372, 27589, -4965,  1411,  -187,   -31,   748, -3069, 11200, 27714, -4945,  1407,  -188,
      -30,   736, -3027, 11029, 27838, -4924,  1402,  -188,   -29,   724, -2985, 10858, 27960, -4902,  1397,  -189,
      -28,   713, -2943, 10687, 28081, -4879,  1391,  -189,   -27,   701, -2901, 10517, 28201, -4855,  1386,  -190,
      -26,   689, -2859, 10347, 28319, -4829,  1379,  -190,   -25,   677, -2817, 10178, 28436, -4803,  1373,  -190,
      -24,   665, -2774, 10009, 28552, -4776,  1366,  -191,   -23,   654, -2732,  9840, 28666, -4747,  1359,  -191,
      -22,   642, -2689,  9672, 28779, -4718,  1352,  -191,   -21,   630, -2646,  9504, 28891, -4687,  1344,  -191,
      -20,   619, -2604,  9337, 29001, -4655,  1336,  -191,   -19,   607, -2561,  9171, 29110, -4623,  1328,  -191,
      -18,   595, -2518,  9005, 29218, -4589,  1319,  -191,   -18,   584, -2475,  8839, 29324, -4554,  1310,  -191,
      -17,   572, -2432,  8674, 29428, -4518,  1300,  -190,   -16,   561, -2389,  8510, 29532, -4480,  1290,  -190,
      -15,   549, -2346,  8346, 29633, -4442,  1280,  -189,   -14,   538, -2303,  8183, 29734, -4402,  1270,  -189,
      -14,   527, -2260,  8020, 29833, -4362,  1259,  -188,   -13,   515, -2217,  7858, 29930, -4320,  1247,  -188,
      -12,   504, -2174,  7697, 30026, -4277,  1236,  -187,   -12,   493, -2132,  7536, 30120, -4233,  1224,  -186,
      -11,   482, -2089,  7376, 30213, -4188,  1211,  -185,   -10,   471, -2046,  7216, 30304, -4142,  1199,  -184,
      -10,   460, -2003,  7058, 30394, -4094,  1186,  -183,    -9,   449, -1960,  6900, 30482, -4046,  1172,  -182,
       -9,   438, -1918,  6742, 30569, -3996,  1158,  -181,    -8,   427, -1875,  6586, 30654, -3945,  1144,  -180,
       -8,   416, -1833,  6430, 30738, -3893,  1130,  -178,    -7,   405, -1790,  6275, 30820, -3840,  1115,  -177,
       -7,   395, -1748,  6120, 30900, -3785,  1100,  -175,    -6,   384, -1706,  5967, 30979, -3730,  1084,  -174,
       -6,   373, -1663,  5814, 31056, -3673,  1068,  -172,    -5,   363, -1621,  5662, 31132, -3615,  1051,  -170,
       -5,   353, -1580,  5510, 31206, -3556,  1035,  -168,    -5,   342, -1538,  5360, 31278, -3495,  1018,  -166,
       -4,   332, -1496,  5210, 31349, -3434,  1000,  -164,    -4,   322, -1455,  5061, 31418, -3371,   982,  -162,
       -4,   312, -1413,  4913, 31485, -3307,   964,  -160,    -3,   302, -1372,  4766, 31551, -3242,   945,  -158,
       -3,   292, -1331,  4620, 31615, -3176,   926,  -155,    -3,   282, -1290,  4474, 31678, -3108,   907,  -153,
       -2,   272, -1249,  4330, 31738, -3040,   887,  -150,    -2,   263, -1209,  4186, 31798, -2970,   867,  -147,
       -2,   253, -1168,  4044, 31855, -2899,   847,  -144,    -2,   244, -1128,  3902, 31911, -2827,   826,  -142,
       -2,   234, -1088,  3761, 31964, -2753,   805,  -139,    -1,   225, -1048,  3621, 32017, -2679,   783,  -135,
       -1,   216, -1009,  3482, 32067, -2603,   761,  -132,    -1,   207,  -969,  3344, 32116, -2526,   739,  -129,
       -1,   198,  -930,  3206, 32163, -2448,   716,  -125,    -1,   189,  -891,  3070, 32208, -2368,   693,  -122,
       -1,   180,  -852,  2935, 32252, -2288,   669,  -118,     0,   171,  -814,  2801, 32294, -2206,   646,  -115,
        0,   163,  -775,  2667, 32334, -2123,   621,  -111,     0,   154,  -737,  2535, 32372, -2039,   597,  -107,
        0,   146,  -699,  2404, 32409, -1953,   572,  -103,     0,   138,  -662,  2274, 32444, -1867,   547,   -99,
        0,   129,  -624,  2144, 32477, -1779,   521,   -94,     0,   121,  -587,  2016, 32508, -1690,   495,   -90,
        0,   113,  -550,  1889, 32538, -1600,   469,   -86,     0,   105,  -514,  1763, 32566, -1509,   442,   -81,
        0,    98,  -478,  1638, 32591, -1416,   415,   -76,     0,    90,  -441,  1514, 32616, -1323,   387,   -72,
        0,    82,  -406,  1391, 32638, -1228,   360,   -67,     0,    75,  -370,  1269, 32659, -1132,   331,   -62,
        0,    67,  -335,  1148, 32678, -1035,   303,   -57,     0,    60,  -300,  1028, 32695,  -936,   274,   -51,
        0,    53,  -266,   909, 32710,  -837,   245,   -46,     0,    46,  -231,   792, 32723,  -736,   215,   -41,
        0,    39,  -197,   675, 32735,  -635,   186,   -35,     0,    32,  -163,   560, 32745,  -532,   155,   -29,
        0,    25,  -130,   446, 32753,  -427,   125,   -24,     0,    19,   -97,   332, 32759,  -322,    94,   -18,
        0,    12,   -64,   220, 32764,  -216,    63,   -12,     0,     6,   -32,   109, 32767,  -108,    31,    -6
];

// 4-point Cubic Hermite spline kernel
pub const CUBIC_SPLINE_KERNEL_SIZE: usize = 1024;
pub const CUBIC_SPLINE_KERNEL: [i16; CUBIC_SPLINE_KERNEL_SIZE] = [
        0, 32767,     0,     0,   -63, 32765,    64,     0,  -126, 32762,   131,     0,  -187, 32755,   200,    -2,
     -248, 32747,   271,    -3,  -307, 32736,   344,    -6,  -366, 32722,   419,    -8,  -423, 32706,   495,   -11,
     -480, 32688,   574,   -15,  -536, 32667,   654,   -19,  -590, 32644,   737,   -24,  -644, 32619,   821,   -28,
     -697, 32592,   906,   -34,  -749, 32562,   994,   -40,  -800, 32530,  1083,   -46,  -850, 32495,  1175,   -52,
     -899, 32459,  1267,   -59,  -948, 32420,  1362,   -67,  -995, 32379,  1458,   -75, -1042, 32335,  1556,   -83,
    -1087, 32290,  1656,   -92, -1132, 32242,  1757,  -101, -1176, 32193,  1860,  -110, -1219, 32141,  1965,  -120,
    -1261, 32087,  2071,  -130, -1302, 32031,  2179,  -140, -1343, 31973,  2288,  -151, -1382, 31913,  2399,  -163,
    -1421, 31851,  2511,  -174, -1459, 31787,  2625,  -186, -1496, 31721,  2740,  -198, -1532, 31653,  2857,  -211,
    -1567, 31583,  2975,  -223, -1602, 31511,  3095,  -237, -1636, 31437,  3216,  -250, -1669, 31361,  3339,  -264,
    -1701, 31283,  3463,  -278, -1732, 31204,  3588,  -292, -1763, 31122,  3715,  -307, -1793, 31039,  3843,  -322,
    -1822, 30954,  3972,  -337, -1850, 30867,  4102,  -352, -1878, 30779,  4234,  -368, -1905, 30688,  4367,  -384,
    -1931, 30596,  4502,  -400, -1956, 30502,  4637,  -417, -1980, 30407,  4774,  -433, -2004, 30309,  4912,  -450,
    -2027, 30211,  5051,  -467, -2050, 30110,  5192,  -485, -2072, 30008,  5333,  -502, -2092, 29904,  5476,  -520,
    -2113, 29799,  5619,  -538, -2132, 29692,  5764,  -556, -2151, 29583,  5910,  -575, -2169, 29473,  6057,  -593,
    -2187, 29361,  6205,  -612, -2204, 29248,  6354,  -631, -2220, 29133,  6504,  -650, -2235, 29017,  6655,  -669,
    -2250, 28899,  6806,  -689, -2265, 28780,  6959,  -708, -2278, 28660,  7113,  -728, -2291, 28538,  7268,  -748,
    -2303, 28415,  7423,  -767, -2315, 28290,  7580,  -788, -2326, 28164,  7737,  -808, -2337, 28037,  7895,  -828,
    -2346, 27908,  8054,  -848, -2356, 27778,  8214,  -869, -2364, 27647,  8374,  -890, -2372, 27514,  8536,  -910,
    -2380, 27380,  8698,  -931, -2387, 27245,  8861,  -952, -2393, 27109,  9024,  -973, -2399, 26971,  9188,  -994,
    -2404, 26833,  9353, -1015, -2409, 26693,  9519, -1036, -2413, 26552,  9685, -1057, -2416, 26410,  9852, -1078,
    -2419, 26267, 10019, -1099, -2422, 26122, 10187, -1121, -2424, 25977, 10356, -1142, -2425, 25831, 10525, -1163,
    -2426, 25683, 10695, -1185, -2427, 25535, 10865, -1206, -2427, 25385, 11036, -1227, -2426, 25235, 11207, -1249,
    -2425, 25083, 11379, -1270, -2423, 24931, 11551, -1291, -2421, 24777, 11723, -1313, -2419, 24623, 11896, -1334,
    -2416, 24468, 12070, -1355, -2412, 24312, 12244, -1376, -2409, 24155, 12418, -1397, -2404, 23997, 12592, -1418,
    -2399, 23839, 12767, -1439, -2394, 23679, 12942, -1460, -2389, 23519, 13118, -1481, -2382, 23358, 13293, -1502,
    -2376, 23196, 13469, -1523, -2369, 23034, 13646, -1544, -2362, 22871, 13822, -1564, -2354, 22707, 13999, -1585,
    -2346, 22542, 14176, -1605, -2337, 22377, 14353, -1625, -2329, 22211, 14530, -1645, -2319, 22045, 14707, -1665,
    -2310, 21877, 14884, -1685, -2300, 21710, 15062, -1705, -2289, 21541, 15240, -1725, -2279, 21372, 15417, -1744,
    -2267, 21203, 15595, -1763, -2256, 21033, 15773, -1783, -2244, 20862, 15951, -1802, -2232, 20691, 16128, -1820,
    -2220, 20520, 16306, -1839, -2207, 20348, 16484, -1858, -2194, 20175, 16661, -1876, -2181, 20003, 16839, -1894,
    -2167, 19829, 17016, -1912, -2153, 19656, 17194, -1930, -2139, 19482, 17371, -1947, -2124, 19307, 17548, -1964,
    -2109, 19133, 17725, -1982, -2094, 18958, 17902, -1998, -2079, 18782, 18078, -2015, -2063, 18607, 18255, -2031,
    -2047, 18431, 18431, -2047, -2031, 18255, 18607, -2063, -2015, 18078, 18782, -2079, -1998, 17902, 18958, -2094,
    -1982, 17725, 19133, -2109, -1964, 17548, 19307, -2124, -1947, 17371, 19482, -2139, -1930, 17194, 19656, -2153,
    -1912, 17016, 19829, -2167, -1894, 16839, 20003, -2181, -1876, 16661, 20175, -2194, -1858, 16484, 20348, -2207,
    -1839, 16306, 20520, -2220, -1820, 16128, 20691, -2232, -1802, 15951, 20862, -2244, -1783, 15773, 21033, -2256,
    -1763, 15595, 21203, -2267, -1744, 15417, 21372, -2279, -1725, 15240, 21541, -2289, -1705, 15062, 21710, -2300,
    -1685, 14884, 21877, -2310, -1665, 14707, 22045, -2319, -1645, 14530, 22211, -2329, -1625, 14353, 22377, -2337,
    -1605, 14176, 22542, -2346, -1585, 13999, 22707, -2354, -1564, 13822, 22871, -2362, -1544, 13646, 23034, -2369,
    -1523, 13469, 23196, -2376, -1502, 13293, 23358, -2382, -1481, 13118, 23519, -2389, -1460, 12942, 23679, -2394,
    -1439, 12767, 23839, -2399, -1418, 12592, 23997, -2404, -1397, 12418, 24155, -2409, -1376, 12244, 24312, -2412,
    -1355, 12070, 24468, -2416, -1334, 11896, 24623, -2419, -1313, 11723, 24777, -2421, -1291, 11551, 24931, -2423,
    -1270, 11379, 25083, -2425, -1249, 11207, 25235, -2426, -1227, 11036, 25385, -2427, -1206, 10865, 25535, -2427,
    -1185, 10695, 25683, -2426, -1163, 10525, 25831, -2425, -1142, 10356, 25977, -2424, -1121, 10187, 26122, -2422,
    -1099, 10019, 26267, -2419, -1078,  9852, 26410, -2416, -1057,  9685, 26552, -2413, -1036,  9519, 26693, -2409,
    -1015,  9353, 26833, -2404,  -994,  9188, 26971, -2399,  -973,  9024, 27109, -2393,  -952,  8861, 27245, -2387,
     -931,  8698, 27380, -2380,  -910,  8536, 27514, -2372,  -890,  8374, 27647, -2364,  -869,  8214, 27778, -2356,
     -848,  8054, 27908, -2346,  -828,  7895, 28037, -2337,  -808,  7737, 28164, -2326,  -788,  7580, 28290, -2315,
     -767,  7423, 28415, -2303,  -748,  7268, 28538, -2291,  -728,  7113, 28660, -2278,  -708,  6959, 28780, -2265,
     -689,  6806, 28899, -2250,  -669,  6655, 29017, -2235,  -650,  6504, 29133, -2220,  -631,  6354, 29248, -2204,
     -612,  6205, 29361, -2187,  -593,  6057, 29473, -2169,  -575,  5910, 29583, -2151,  -556,  5764, 29692, -2132,
     -538,  5619, 29799, -2113,  -520,  5476, 29904, -2092,  -502,  5333, 30008, -2072,  -485,  5192, 30110, -2050,
     -467,  5051, 30211, -2027,  -450,  4912, 30309, -2004,  -433,  4774, 30407, -1980,  -417,  4637, 30502, -1956,
     -400,  4502, 30596, -1931,  -384,  4367, 30688, -1905,  -368,  4234, 30779, -1878,  -352,  4102, 30867, -1850,
     -337,  3972, 30954, -1822,  -322,  3843, 31039, -1793,  -307,  3715, 31122, -1763,  -292,  3588, 31204, -1732,
     -278,  3463, 31283, -1701,  -264,  3339, 31361, -1669,  -250,  3216, 31437, -1636,  -237,  3095, 31511, -1602,
     -223,  2975, 31583, -1567,  -211,  2857, 31653, -1532,  -198,  2740, 31721, -1496,  -186,  2625, 31787, -1459,
     -174,  2511, 31851, -1421,  -163,  2399, 31913, -1382,  -151,  2288, 31973, -1343,  -140,  2179, 32031, -1302,
     -130,  2071, 32087, -1261,  -120,  1965, 32141, -1219,  -110,  1860, 32193, -1176,  -101,  1757, 32242, -1132,
      -92,  1656, 32290, -1087,   -83,  1556, 32335, -1042,   -75,  1458, 32379,  -995,   -67,  1362, 32420,  -948,
      -59,  1267, 32459,  -899,   -52,  1175, 32495,  -850,   -46,  1083, 32530,  -800,   -40,   994, 32562,  -749,
      -34,   906, 32592,  -697,   -28,   821, 32619,  -644,   -24,   737, 32644,  -590,   -19,   654, 32667,  -536,
      -15,   574, 32688,  -480,   -11,   495, 32706,  -423,    -8,   419, 32722,  -366,    -6,   344, 32736,  -307,
       -3,   271, 32747,  -248,    -2,   200, 32755,  -187,     0,   131, 32762,  -126,     0,    64, 32765,   -63
];